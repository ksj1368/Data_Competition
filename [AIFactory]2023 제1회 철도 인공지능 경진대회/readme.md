### 주제 : 열차의 주행 안정성 진단에 사용되는 ‘탈선계수’를 보다 높은 정확도로 예측할 수 있는 인공지능 모델 개발

- 기간 : 2023년 8월 1일 ~ 2023년 8월 28일
- Top 7.3%(5/67)
- 장려상 수상

## Score
- 평가 산식
![image](https://github.com/ksj1368/Data_Competition/assets/83360918/0d8bbfb1-35dc-4afd-ac9e-7f95a5c461b0)

- total score : 78.681525
- public score : 78.7225034

## 데이터 전처리
- feature를 추가하지 않은 데이터와 직선, 곡선 선로에 모두 들어가는 feature를 추가한 뒤 비교를 해본 결과 직선 선로는 탈선계수의 영향이 적고 곡선 선로의 특성이 탈선계수에 영향을 준다고 판단하여 곡선 선로를 중심으로 feature Engineering 진행
- Standard Scaler
  - Train Dataset 표준화를 위해 Standard scaler 사용

### 직선, 곡선 공통
- yaw damper 변수 생성
  - 카테고리 데이터인 yaw damper에 따라 탈선계수 예측
- 총가속도 변수 생성
  - 탈선계수에 가속도가 큰 영향을 준다고 판단하여 가중치를 부여한 변수 생성
- 좌우 프레임의 횡가속도 변수 생성
  - 탈선 계수에 위치 좌우 횡가속도 차가 영향을 주기 때문에 추가한 변수
  - 좌우 프레임의 가속도 차이를 통해 차량의 균형과 조향 특성을 분석
  - 프레임 가속도 차이 = (좌측 프레임 가속도) - (우측 프레임 가속도)
- 차륜 수직하중을 수직 가속도로 나눈 관계 변수 생성
  - 차륜 하중과 프레임 수직 가속도 관계 = 프레임 수직 가속도 / 해당 프레임 위치의 차륜 수직하중
  - 프레임 수직 가속도 = 좌측 전위 대차 프레임 수직 가속도 + 좌측 중앙 대차 프레임 수직 가속도 + 좌측 후위 대차 프레임 수직 가속도 (또는 우측 프레임의 경우)
  - 해당 프레임 위치의 차륜 수직하중 = 좌측 전위 차륜 수직하중 + 좌측 중앙 차륜 수직하중 + 좌측 후위 차륜 수직하중(또는 우측 프레임의 경우)
- 좌우 엑슬박스 횡가속도 차이 변수 생성
  - 탈선계수의 위치 좌우 횡가속도 차가 영향을 주기 때문에 추가한 변수

### 곡선 선로
- 선로 중심부 높이 변화 변수
  - Curve의 lane 데이터에서 중심부 높이 변화가 탈선계수에 영향이 있을 것이라는 가정에 추가한 변수
  - 선로 중심부의 높이 변화 = 캔트 × 곡률
  - 수식 : △H = C×r(△H : 선로 중심부의 높이 변화, C : 캔트 값 (단위 : mm), r : 곡률 값 (단위 : 1/km))
- 기차의 편향력 변수
  - 기차의 편향력이 탈선계수에 영향이 있을 것이라는 가정에 추가한 변수 현재 데이터에서는 기차의 질량은 알 수 없으나 한 기차이기 때문에 질량을 동일하게 1로 가정하여 계산함
  - 기차의 편향력 = (기차의 질량) × (캔트 × 곡률)²
  - 수식 : F = m × (C × r)²
    - (F : 기차의 편향력, m : 기차의 질량, C : 캔트 값 (단위 : mm), r : 곡률 값 (단위 : 1/km))

## Modeling
- 1D-CNN + LSTM
- activation : Selu
  - 음의 부호를 가진 탈선계수를 예측하기 위해서 사용
- optimizer : Nadam
  - NAG + Adam
  - Adam보다 최소값으로 빨리 수렴
  - 실제로 Adam을 사용했을 때의 성능보다 Nadam을 사용했을 때의 성능이 더 좋았음
## 피드백
- pca를 통한 feature Engineering
- 물리, 철도 도메인 부족으로 인한 한계가 느껴졌음
- 탈선은 주로 곡선 선로에서 발생한다고 느꼈고 실제 직선 선로의 loss와 곡선 선로의 loss에서 곡선 선로의 loss가 더 높았음
